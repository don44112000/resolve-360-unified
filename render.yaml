services:
  # QA Environment - NestJS API
  - type: web
    name: resolve-360-qa
    env: node
    region: singapore # Change to your preferred region
    plan: starter # Change to 'standard' or higher for production
    branch: main # Change to your QA branch if different
    buildCommand: npm install && npm run build
    startCommand: npm run start:prod
    healthCheckPath: /health
    autoDeploy: true

    envVars:
      # Node Environment
      - key: NODE_ENV
        value: qa

      - key: PORT
        value: 3000

      # Database Configuration (Aiven PostgreSQL)
      # Set these in Render Dashboard as they contain sensitive values
      - key: POSTGRES_HOST
        sync: false # Will be set manually in Render dashboard

      - key: POSTGRES_PORT
        sync: false

      - key: POSTGRES_USER
        sync: false

      - key: POSTGRES_PASSWORD
        sync: false

      - key: POSTGRES_DB
        sync: false

      - key: POSTGRES_SSL
        value: true

      # Redis Configuration
      # Set these in Render Dashboard
      - key: REDIS_HOST
        sync: false

      - key: REDIS_PORT
        value: 6379

      - key: REDIS_PASSWORD
        sync: false

      # JWT Configuration
      - key: JWT_SECRET
        sync: false # Generate a secure random string

      - key: JWT_EXPIRATION
        value: 1d

      # API Configuration
      - key: API_PREFIX
        value: api

      - key: API_VERSION
        value: v1

      # Logging
      - key: LOG_LEVEL
        value: info
